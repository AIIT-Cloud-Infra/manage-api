# テスト手順書

## アカウントの登録
```sh
curl -X 'POST' http://localhost:3000/users/signup \
  -d 'email=a2040hm@aiit.ac.jp' \
  -d 'password=test12345'
```

## トークン発行
```sh
curl -X 'POST' http://localhost:3000/users/signin \
  -d 'email=a2040hm@aiit.ac.jp' \
  -d 'password=test12345' | jq
```

## VM起動イメージ一覧の表示
```sh
curl http://localhost:3000/base_imgs \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV' | jq
```

## VM起動
- メモリ: 1024
- CPU: 1
```sh
curl -X 'POST' http://localhost:3000/instances \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV' \
  -d 'base_img=centos7' \
  -d 'memory=1024' \
  -d 'cpu=1'
```

- メモリ: 2048
- CPU: 2
```sh
curl -X 'POST' http://localhost:3000/instances \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV' \
  -d 'base_img=centos7' \
  -d 'memory=2048' \
  -d 'cpu=2'
```

## キャパシティオーバーの確認
```sh
curl -X 'POST' http://localhost:3000/instances \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV' \
  -d 'base_img=centos7' \
  -d 'memory=1024' \
  -d 'cpu=10' | jq
```

## MySQL内を確認
```sh
mysql -u apuser -p<password> master_db
> SELECT * FROM instances\G
```

## VM一覧の表示
```sh
curl http://localhost:3000/instances \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV' | jq
```

## VM単体の表示
```sh
curl http://localhost:3000/instances/0d6c0b28-ea56-4341-9573-daacda87ef8c \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV' | jq
```

## SSHキー取得
```sh
curl http://localhost:3000/instances/9909ab01-0539-4ccb-b20d-b8c8842ff35f/ssh_key \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV' | jq
```

## SSH接続
```sh

```

## VM削除
```sh
curl -X 'DELETE' http://localhost:3000/instances/9909ab01-0539-4ccb-b20d-b8c8842ff35f \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV'
```

## VM停止
```sh
curl -X 'POST' http://localhost:3000/instances/9909ab01-0539-4ccb-b20d-b8c8842ff35f/stop \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV'
```

## VM再開
```sh
curl -X 'POST' http://localhost:3000/instances/9909ab01-0539-4ccb-b20d-b8c8842ff35f/start \
  -H 'X-AUTH-TOKEN: m2Jwrn0O2gB8SmHV'
```

